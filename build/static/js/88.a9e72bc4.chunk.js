"use strict";(self.webpackChunkmarket_content_app=self.webpackChunkmarket_content_app||[]).push([[88],{88:(e,r,a)=>{a.r(r),a.d(r,{default:()=>g});var s=a(5043),t=a(184),l=a(1458),o=a(579);const n=function(e){let{onClose:r,onAddProgram:a,onFetching:t}=e;const n=JSON.parse(localStorage.getItem("userData")),[c,d]=(0,s.useState)({title:"",description:"",selectedRules:[],created_by:"".concat(n[1]," ").concat(n[2])}),i=e=>{const{name:r,value:a}=e.target;d({...c,[r]:a})},[m,p]=(0,s.useState)([]);(0,s.useEffect)((()=>{h()}),[]);const h=async()=>{try{const e=await fetch("/list_rules"),r=await e.json();"SUCCESS"===r.status?(console.log("Rule in Edit COMP: ",r.data),p(r.data.map((e=>({value:e.rulename,label:e.rulename}))))):console.error("Failed to fetch rules:",r.data)}catch(e){console.error("Error fetching rules:",e)}};return(0,o.jsx)("div",{className:"add-new-program-overlay",children:(0,o.jsxs)("div",{className:"add-new-program",children:[(0,o.jsxs)("div",{className:"add-new-program-header",children:[(0,o.jsx)("div",{children:"Add New Product"}),(0,o.jsx)("button",{className:"add-new-program-close",onClick:r,children:"\xd7"})]}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"add-new-program-body",children:[(0,o.jsxs)("div",{className:"floating-label-input",children:[(0,o.jsx)("input",{type:"text",name:"title",value:c.title,onChange:i,required:!0,placeholder:" "}),(0,o.jsx)("label",{children:"Product Title*"})]}),(0,o.jsxs)("div",{className:"floating-label-input",children:[(0,o.jsx)("input",{type:"text",name:"description",value:c.description,onChange:i,required:!0,placeholder:" "}),(0,o.jsx)("label",{children:"Description*"})]}),(0,o.jsxs)("div",{className:"select-container",children:[(0,o.jsx)(l.Ay,{isMulti:!0,closeMenuOnSelect:!1,name:"rules",options:m,className:"basic-multi-select",classNamePrefix:"select",onChange:e=>{const r=e.map((e=>e.value));d({...c,selectedRules:r})},placeholder:"Search ",required:!0}),(0,o.jsx)("label",{children:"Select Rules*"})]})]}),(0,o.jsxs)("div",{className:"add-new-program-footer",children:[(0,o.jsx)("button",{className:"add-new-program-add",onClick:async()=>{const{title:e,description:s,selectedRules:l,created_by:o}=c;if(e&&s&&l.length>0)try{const n=await fetch("/add_program",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:s,rules:l,created_by:o})}),c=await n.json();"SUCCESS"===c.status?(alert("Program added successfully!"),a([e,s,l,o]),t(),r()):alert("Failed to add program: "+c.data)}catch(n){console.error("Error adding program:",n),alert("Error adding program")}else alert("Please enter title, description, and select at least one rule")},children:"Add"}),(0,o.jsx)("button",{className:"add-new-program-cancel",onClick:r,children:"Cancel"})]})]})})};const c=function(e){let{onClose:r,program:a,onEditProgram:t,fetchPrograms:n}=e;const[c,d]=(0,s.useState)(""),[i,m]=(0,s.useState)(""),[p,h]=(0,s.useState)([]),[u,g]=(0,s.useState)([]);(0,s.useEffect)((()=>{a&&(d(a.programName),m(a.description),x(a.programID))}),[a]),(0,s.useEffect)((()=>{j()}),[]);const j=async()=>{try{const e=await fetch("/list_rules"),r=await e.json();"SUCCESS"===r.status?(console.log("Rule in Edit COMP: ",r.data),g(r.data.map((e=>({value:e.rulename,label:e.rulename}))))):console.error("Failed to fetch rules:",r.data)}catch(e){console.error("Error fetching rules:",e)}},x=async e=>{try{const r=await fetch("/get_mapped_rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program_id:e})}),a=await r.json();"SUCCESS"===a.status?h(a.data.map((e=>({value:e.rulename,label:e.rulename})))):console.error("Failed to fetch mapped rules:",a.data)}catch(r){console.error("Error fetching mapped rules:",r)}};return(0,o.jsx)("div",{className:"edit-program-overlay",children:(0,o.jsxs)("div",{className:"edit-program",children:[(0,o.jsxs)("div",{className:"edit-program-header",children:[(0,o.jsx)("div",{children:"Edit Product"}),(0,o.jsx)("button",{className:"edit-program-close",onClick:r,children:"\xd7"})]}),(0,o.jsx)("hr",{}),(0,o.jsxs)("form",{className:"edit-program-form",children:[(0,o.jsx)("div",{className:"edit-program-form-row",children:(0,o.jsxs)("div",{className:"floating-label-input",children:[(0,o.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),required:!0,placeholder:" "}),(0,o.jsx)("label",{children:"Product Title*"})]})}),(0,o.jsx)("div",{className:"edit-program-form-row",children:(0,o.jsxs)("div",{className:"floating-label-input",children:[(0,o.jsx)("input",{type:"text",value:i,onChange:e=>m(e.target.value),required:!0,placeholder:" "}),(0,o.jsx)("label",{children:"Description*"})]})}),(0,o.jsxs)("div",{className:"select-container",children:[(0,o.jsx)(l.Ay,{isMulti:!0,closeMenuOnSelect:!1,name:"rules",options:u,value:p,className:"basic-multi-select",classNamePrefix:"select",onChange:e=>{h(e)},placeholder:"Select Rules",required:!0}),(0,o.jsx)("label",{children:"Select Rules*"})]})]}),(0,o.jsxs)("div",{className:"edit-program-footer",children:[(0,o.jsx)("button",{className:"edit-program-save",onClick:async()=>{if(c&&i&&i)try{const e=await fetch("/edit_program",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program_id:a.programID,name:c,description:i,rules:p.map((e=>e.value))})}),s=await e.json();"SUCCESS"===s.status?(alert("Program edited successfully!"),t([c,i,a[2]]),n(),r()):alert("Failed to edit program: "+s.data)}catch(e){console.error("Error editing program:",e),alert("Error editing program")}else alert("Please enter both title and description")},children:"Save"}),(0,o.jsx)("button",{className:"edit-program-cancel",onClick:r,children:"Cancel"})]})]})})};const d=function(e){let{onClose:r,onDelete:a,program:s}=e;return(0,o.jsx)("div",{className:"delete-program-overlay",children:(0,o.jsxs)("div",{className:"delete-program",children:[(0,o.jsxs)("div",{className:"delete-program-header",children:[(0,o.jsx)("div",{children:"Delete Product"}),(0,o.jsx)("button",{className:"delete-program-close",onClick:r,children:"\xd7"})]}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"delete-program-body",children:["Are you sure you want to delete product '",(0,o.jsx)("strong",{children:s.programName}),"'?"]}),(0,o.jsxs)("div",{className:"delete-program-footer",children:[(0,o.jsx)("button",{className:"delete-program-confirm",onClick:async()=>{try{const e=await fetch("/delete_program",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({program_id:s.programID})}),t=await e.json();"SUCCESS"===t.status?(alert("Program deleted successfully!"),a(s),r()):alert("Failed to delete program: "+t.data)}catch(e){console.error("Error deleting program:",e),alert("Error deleting program")}},children:"Yes, Delete"}),(0,o.jsx)("button",{className:"delete-program-cancel",onClick:r,children:"Cancel"})]})]})})};var i=a(9563);const m="SuperAdmin",p="Admin",h="Write",u="Read";const g=function(){const[e,r]=(0,s.useState)([]),[a,l]=(0,s.useState)(null),[g,j]=(0,s.useState)(!1),[x,y]=(0,s.useState)(!1),[f,N]=(0,s.useState)(!1),[S,b]=(0,s.useState)(null),[C,v]=(0,s.useState)(!1),[_,w]=(0,s.useState)(null);(0,s.useEffect)((()=>{D();const e=JSON.parse(localStorage.getItem("userData"));e&&w(e[6])}),[]);const D=async()=>{v(!0);try{const e=await fetch("/list_programs"),a=await e.json();"success"===a.body.status?r(a.body.data):console.error("Failed to fetch programs:",a.body.data)}catch(e){console.error("Error fetching programs:",e)}finally{v(!1)}},P=async s=>{const t=s.programID;if(a===t)l(null);else{const a=await(async e=>{try{console.log("Program id for fetchMappedRules: ",e);const r=await fetch("/get_mapped_rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program_id:e})}),a=await r.json();return console.log("DATAAAAAAAAAAAAAA: ",a),"SUCCESS"===a.status?(console.log("Fetched Rules for Program IDDDDDDDD:",e,a.data),a.data.map((e=>({value:e.rulename,label:e.rulename,mediaType:e.media_type,disclaimer:e.disclaimer})))):(console.error("Failed to fetch mapped rules:",a.body.data),[])}catch(r){return console.error("Error fetching mapped rules:",r),[]}})(t);console.log("Rules to be set for Program ID:",t,a);const s=e.map((e=>e.programID===t?{...e,rules:a}:e));console.log("Updated Programs State:",s),r(s),l(t)}};return(0,o.jsxs)("div",{className:"program-types",children:[(0,o.jsxs)("div",{className:"program-types-heading",children:[(0,o.jsx)("div",{className:"program-type-page-header",children:"Product Types"}),(_===m||_===p||_===h)&&(0,o.jsx)("div",{children:(0,o.jsx)("button",{className:"program-types__add-new-button",onClick:()=>j(!0),children:"+ Add New"})})]}),(0,o.jsxs)("table",{className:"program-types__content-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Type of Product"}),(0,o.jsx)("th",{children:"Description"}),(0,o.jsx)("th",{children:"Created by"}),(0,o.jsx)("th",{children:"Created DateTime"}),(_===m||_===p||_===h)&&(0,o.jsx)("th",{children:"Action"}),(0,o.jsx)("th",{})]})}),C?(0,o.jsx)("div",{className:"loader",children:(0,o.jsx)(i.A,{})}):(0,o.jsx)("tbody",{children:e.length>0?e.map((e=>(0,o.jsxs)(s.Fragment,{children:[(0,o.jsxs)("tr",{onClick:()=>P(e),className:"program-types__program-row",children:[(0,o.jsx)("td",{children:e.programName}),(0,o.jsx)("td",{children:e.description}),(0,o.jsx)("td",{children:e.created_by}),(0,o.jsx)("td",{children:e.created_at}),(_===m||_===p||_===h)&&(0,o.jsxs)("td",{children:[(_===m||_===p||_===h)&&(0,o.jsxs)("button",{className:"program-types__edit-button",onClick:r=>{r.stopPropagation(),(e=>{b(e),y(!0)})(e)},children:[(0,o.jsx)(t.uO9,{})," Edit"]}),_===m&&(0,o.jsxs)("button",{className:"program-types__delete-button",onClick:r=>{r.stopPropagation(),(e=>{b(e),N(!0)})(e)},children:[(0,o.jsx)(t.qbC,{})," Delete"]})]}),(0,o.jsx)("td",{children:a===e.programID?(0,o.jsx)(t.Ucs,{className:"expand-icon"}):(0,o.jsx)(t.Vr3,{className:"expand-icon"})})]}),a===e.programID&&(0,o.jsx)("tr",{className:"program-types__rules-row",children:(0,o.jsx)("td",{colSpan:_===m||_===p||_===h||_===u?6:5,children:(0,o.jsxs)("table",{className:"program-types_associated_rules",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Rule Name"}),(0,o.jsx)("th",{children:"Media Type"}),(0,o.jsx)("th",{children:"Rule Definition"})]})}),(0,o.jsx)("tbody",{children:Array.isArray(e.rules)&&e.rules.length>0?e.rules.map(((e,r)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.label}),(0,o.jsx)("td",{children:e.mediaType}),(0,o.jsx)("td",{children:e.disclaimer})]},r))):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"3",children:"No rules found"})})})]})})})]},e.programID))):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:_===m||_===p||_===h?6:5,children:"No programs found"})})})]}),g&&(0,o.jsx)(n,{onClose:()=>j(!1),onAddProgram:a=>{r([...e,a])},onFetching:D}),x&&(0,o.jsx)(c,{onClose:()=>y(!1),program:S,onEditProgram:a=>{r(e.map((e=>e.programID===a.programID?a:e)))},fetchPrograms:D}),f&&(0,o.jsx)(d,{onClose:()=>N(!1),program:S,onDelete:a=>{r(e.filter((e=>e.programID!==a.programID)))}})]})}},9563:(e,r,a)=>{a.d(r,{A:()=>t});a(5043);var s=a(579);const t=()=>(0,s.jsx)("div",{className:"spinner"})}}]);
//# sourceMappingURL=88.a9e72bc4.chunk.js.map