"use strict";(self.webpackChunkmarket_content_app=self.webpackChunkmarket_content_app||[]).push([[950],{9563:(e,s,a)=>{a.d(s,{A:()=>t});a(5043);var l=a(579);const t=()=>(0,l.jsx)("div",{className:"spinner"})},2950:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var l=a(5043),t=a(184),r=a(579);const n=function(e){let{onClose:s,onAddUser:a}=e;const[n,i]=(0,l.useState)({firstName:"",lastName:"",email:"",phoneNumber:"",password:"",confirmPassword:"",role:"",status:""}),[d,o]=(0,l.useState)({passwordMatch:!1,invalidPhoneNumber:!1}),[c,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(!1),x=e=>{const{name:s,value:a}=e.target;if(i({...n,[s]:a}),"phoneNumber"===s){const e=/^\d{10}$/.test(a);o({...d,invalidPhoneNumber:!e})}};return(0,r.jsx)("div",{className:"add-new-user-modal-overlay",children:(0,r.jsxs)("div",{className:"add-new-user-modal-content",children:[(0,r.jsxs)("div",{className:"add-new-user-header",children:[(0,r.jsx)("div",{children:"Add New User"}),(0,r.jsx)("button",{className:"add-new-user-close-button",onClick:s,children:"\xd7"})]}),(0,r.jsx)("hr",{}),(0,r.jsxs)("form",{className:"new-user-form",onSubmit:async e=>{if(e.preventDefault(),n.password===n.confirmPassword){if(o({...d,passwordMatch:!1}),!d.invalidPhoneNumber)try{const e=await fetch("/add_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:n.firstName,lastName:n.lastName,email:n.email,phoneNumber:n.phoneNumber,password:n.password,role:n.role,status:n.status})}),l=await e.json();e.ok&&"SUCCESS"===l.status?(alert("User added successfully!"),a(),s()):alert("Failed to add user: "+(l.message||"Unknown error"))}catch(l){console.error("Error adding user:",l),alert("Error adding user")}}else o({...d,passwordMatch:!0})},children:[(0,r.jsxs)("div",{className:"add-new-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"text",name:"firstName",value:n.firstName,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"First Name*"})]}),(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"text",name:"lastName",value:n.lastName,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Last Name*"})]})]}),(0,r.jsxs)("div",{className:"add-new-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"email",name:"email",value:n.email,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Email*"})]}),(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"tel",name:"phoneNumber",value:n.phoneNumber,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Phone Number*"}),d.invalidPhoneNumber&&(0,r.jsx)("div",{className:"error-message",children:"Invalid phone number"})]})]}),(0,r.jsxs)("div",{className:"add-new-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"password-wrapper floating-label-input",children:[(0,r.jsx)("input",{type:c?"text":"password",name:"password",value:n.password,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Password*"}),(0,r.jsx)("span",{className:"user-password-toggle",onClick:()=>u(!c),children:c?(0,r.jsx)(t.Ny1,{}):(0,r.jsx)(t.mx3,{})})]}),(0,r.jsxs)("div",{className:"password-wrapper floating-label-input",children:[(0,r.jsx)("input",{type:m?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:x,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Confirm Password*"}),(0,r.jsx)("span",{className:"user-password-toggle",onClick:()=>h(!m),children:m?(0,r.jsx)(t.Ny1,{}):(0,r.jsx)(t.mx3,{})})]})]}),d.passwordMatch&&(0,r.jsx)("div",{className:"add-new-user-form-row error-message",children:"Passwords do not match"}),(0,r.jsxs)("div",{className:"add-new-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"select-container floating-label-input",children:[(0,r.jsxs)("select",{name:"role",value:n.role,onChange:x,required:!0,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select Role"}),(0,r.jsx)("option",{value:"SuperAdmin",children:"SuperAdmin"}),(0,r.jsx)("option",{value:"Admin",children:"Admin"}),(0,r.jsx)("option",{value:"Write",children:"Write"}),(0,r.jsx)("option",{value:"Read",children:"Read"})]}),(0,r.jsx)("label",{children:"Role*"})]}),(0,r.jsxs)("div",{className:"select-container floating-label-input",children:[(0,r.jsxs)("select",{name:"status",value:n.status,onChange:x,required:!0,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select Status"}),(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"InActive",children:"InActive"})]}),(0,r.jsx)("label",{children:"Active Status*"})]})]}),(0,r.jsxs)("div",{className:"form-actions",children:[(0,r.jsx)("button",{type:"submit",children:"Add User"}),(0,r.jsx)("button",{type:"button",onClick:s,children:"Cancel"})]})]})]})})};const i=function(e){let{onClose:s,user:a,onEditUser:t,fetching:n}=e;const[i,d]=(0,l.useState)({firstName:"",lastName:"",email:"",phoneNumber:"",role:"",status:""}),[o,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1);(0,l.useEffect)((()=>{a&&d({user_id:a.userID,firstName:a.firstName,lastName:a.lastName,email:a.email,phoneNumber:a.phoneNumber,role:a.role,status:a.status})}),[a]);const h=e=>{const{name:s,value:a}=e.target;d({...i,[s]:a})};return(0,r.jsx)("div",{className:"edit-user-overlay",children:(0,r.jsxs)("div",{className:"edit-user-modal-content",children:[(0,r.jsxs)("div",{className:"edit-user-header",children:[(0,r.jsx)("div",{children:"Edit User"}),(0,r.jsx)("button",{className:"edit-user-close-button",onClick:s,children:"\xd7"})]}),(0,r.jsx)("hr",{}),(0,r.jsxs)("form",{className:"edit-user-form",onSubmit:async e=>{if(e.preventDefault(),i.firstName&&i.lastName&&i.email&&i.phoneNumber)try{const e=await fetch("/edit_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:i.user_id,firstName:i.firstName,lastName:i.lastName,email:i.email,phoneNumber:i.phoneNumber,role:i.role,status:i.status})}),a=await e.json();"SUCCESS"===a.status?(alert("User edited successfully!"),t({user_id:i.user_id,firstName:i.firstName,lastName:i.lastName,email:i.email,phoneNumber:i.phoneNumber,role:i.role,status:i.status}),n(),s()):alert("Failed to edit user: "+a.data)}catch(a){console.error("Error editing user:",a),alert("Error editing user")}else alert("Please enter all required fields")},children:[(0,r.jsxs)("div",{className:"edit-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"text",name:"firstName",value:i.firstName,onChange:h,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"First Name*"})]}),(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"text",name:"lastName",value:i.lastName,onChange:h,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Last Name*"})]})]}),(0,r.jsxs)("div",{className:"edit-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"email",name:"email",value:i.email,onChange:h,required:!0,placeholder:" ",disabled:!0,className:"blurred-input"}),(0,r.jsx)("label",{children:"Email*"})]}),(0,r.jsxs)("div",{className:"floating-label-input",children:[(0,r.jsx)("input",{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:h,required:!0,placeholder:" "}),(0,r.jsx)("label",{children:"Phone Number*"})]})]}),(0,r.jsxs)("div",{className:"edit-user-form-row two-columns",children:[(0,r.jsxs)("div",{className:"select-container floating-label-input",children:[(0,r.jsxs)("select",{name:"role",value:i.role,onChange:h,required:!0,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select User Role"}),(0,r.jsx)("option",{value:"SuperAdmin",children:"SuperAdmin"}),(0,r.jsx)("option",{value:"Admin",children:"Admin"}),(0,r.jsx)("option",{value:"Write",children:"Write"}),(0,r.jsx)("option",{value:"Read",children:"Read"})]}),(0,r.jsx)("label",{children:"Role*"})]}),(0,r.jsxs)("div",{className:"select-container floating-label-input",children:[(0,r.jsxs)("select",{name:"status",value:i.status,onChange:h,required:!0,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select Status"}),(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"InActive",children:"InActive"})]}),(0,r.jsx)("label",{children:"Active Status*"})]})]}),(0,r.jsxs)("div",{className:"form-actions",children:[(0,r.jsx)("button",{type:"submit",children:"Save"}),(0,r.jsx)("button",{type:"button",onClick:s,children:"Cancel"})]})]})]})})};const d=function(e){let{onClose:s,onDelete:a,user:l}=e;return(0,r.jsx)("div",{className:"delete-user-overlay",children:(0,r.jsxs)("div",{className:"delete-user",children:[(0,r.jsxs)("div",{className:"delete-user-header",children:[(0,r.jsx)("div",{children:"Delete User"}),(0,r.jsx)("button",{className:"delete-user-close",onClick:s,children:"\xd7"})]}),(0,r.jsx)("hr",{}),(0,r.jsxs)("div",{className:"delete-user-body",children:["Are you sure you want to delete '",(0,r.jsxs)("strong",{children:[l.firstName," ",l.lastName]}),"'?"]}),(0,r.jsxs)("div",{className:"delete-user-footer",children:[(0,r.jsx)("button",{className:"delete-user-confirm",onClick:async()=>{try{const e=await fetch("/delete_user",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:l.userID})}),t=await e.json();"SUCCESS"===t.status?(alert("User deleted successfully!"),a(l),s()):alert("Failed to delete user: "+t.data)}catch(e){console.error("Error deleting user:",e),alert("Error deleting user")}},children:"Yes, Delete"}),(0,r.jsx)("button",{className:"delete-user-cancel",onClick:s,children:"Cancel"})]})]})})};var o=a(9563);const c="SuperAdmin",u="Admin";const m=function(){const[e,s]=(0,l.useState)([]),[a,m]=(0,l.useState)([]),[h,x]=(0,l.useState)(""),[j,p]=(0,l.useState)(!1),[N,v]=(0,l.useState)(!1),[b,f]=(0,l.useState)(!1),[w,g]=(0,l.useState)(null),[y,S]=(0,l.useState)(!1),[C,A]=(0,l.useState)(null);(0,l.useEffect)((()=>{E();const e=JSON.parse(localStorage.getItem("userData"));e&&A(e[6])}),[]);const E=async()=>{S(!0);try{const e=await fetch("/list_users"),a=await e.json();"SUCCESS"===a.body.status?(m(a.body.data),s(a.body.data)):console.error("Failed to fetch users:",a.body.data)}catch(e){console.error("Error fetching users:",e)}finally{S(!1)}},_=(0,l.useCallback)(function(e,s){let a;return function(){for(var l=arguments.length,t=new Array(l),r=0;r<l;r++)t[r]=arguments[r];const n=()=>{clearTimeout(a),e(...t)};clearTimeout(a),a=setTimeout(n,s)}}((async e=>{S(!0);try{const a=await fetch("/filter_user?search=".concat(e)),l=await a.json();"SUCCESS"===l.body.status?s(l.body.data):console.error("Failed to fetch users:",l.body.data)}catch(a){console.error("Error fetching users:",a)}finally{S(!1)}}),300),[]);return(0,r.jsxs)("div",{className:"users",children:[(0,r.jsxs)("div",{className:"users-heading",children:[(0,r.jsx)("div",{className:"users-page-header",children:"Users"}),(0,r.jsxs)("div",{className:"users-search-add",children:[(0,r.jsxs)("div",{className:"users-search-wrapper",children:[(0,r.jsx)("input",{type:"text",value:h,onChange:e=>{const{value:s}=e.target;x(s),_(s)},placeholder:"Search By Username / Email / Role",className:"users-search-input"}),(0,r.jsx)(t.KSO,{className:"users-search-icon"})]}),(C===c||C===u)&&(0,r.jsx)("button",{className:"users__add-new-button",onClick:()=>p(!0),children:"+ Add New"})]})]}),(0,r.jsxs)("table",{className:"users__content-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Username"}),(0,r.jsx)("th",{children:"Email"}),(0,r.jsx)("th",{children:"Role"}),(0,r.jsx)("th",{children:"Status"}),(C===c||C===u)&&(0,r.jsx)("th",{children:"Action"})]})}),y?(0,r.jsx)("div",{className:"loader",children:(0,r.jsx)(o.A,{})}):(0,r.jsx)("tbody",{children:e.length>0?e.map(((e,s)=>(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{children:[e.firstName," ",e.lastName]}),(0,r.jsxs)("td",{className:"email-cell",children:[(0,r.jsxs)("div",{className:"email-tooltip",children:[e.email.length>30?"".concat(e.email.substring(0,30),"..."):e.email,(0,r.jsx)("span",{className:"email-tooltip-text",children:e.email})]}),(0,r.jsx)("input",{type:"text",value:e.email,readOnly:!0,className:"full-email-input"})]}),(0,r.jsx)("td",{children:e.role}),(0,r.jsx)("td",{className:"Active"===e.status?"active-status":"",children:e.status}),(C===c||C===u)&&(0,r.jsxs)("td",{children:[(0,r.jsxs)("button",{className:"users__edit-button",onClick:()=>(e=>{g(e),v(!0)})(e),children:[(0,r.jsx)(t.uO9,{})," Edit"]}),C===c&&(0,r.jsxs)("button",{className:"users__delete-button",onClick:()=>(e=>{g(e),f(!0)})(e),children:[(0,r.jsx)(t.qbC,{})," Delete"]})]})]},s))):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:C===c||C===u?"5":"4",children:"No users found"})})})]}),j&&(0,r.jsx)(n,{onClose:()=>p(!1),onAddUser:e=>{E()}}),N&&(0,r.jsx)(i,{onClose:()=>v(!1),user:w,onEditUser:l=>{const t=e.map((e=>e.userID===l.userID?l:e)),r=a.map((e=>e.userID===l.userID?l:e));s(t),m(r)},fetching:E}),b&&(0,r.jsx)(d,{onClose:()=>f(!1),user:w,onDelete:l=>{const t=e.filter((e=>e.userID!==l.userID)),r=a.filter((e=>e.userID!==l.userID));s(t),m(r)}})]})}}}]);
//# sourceMappingURL=950.a6b959e9.chunk.js.map